<!DOCTYPE html>
<html lang="en-US" ng-app="WhichJSFramework">
<head>
	<title>Which JS Framework</title>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.0/angular.min.js"></script>
    <script src="lib/opentip-native.js"></script>
    <script type="text/javascript">
        var matrixCellsArray = [{
            text: 'Interface Elements',
            threeTilesPerLine: true,
            categories: {
                'basic.widgets': {
                    title: 'Basic Widgets',
                    text: 'buttons, text & number fields...'
                },
                'compound.widgets': {
                    title: 'Compound Widgets',
                    text: 'trees, grids, calendar...'
                },
                'visualizations': {
                    title: 'Visualizations',
                    text: 'charts, infographics'
                },
                'containers': {
                    title: 'Containers',
                    text: 'cards, tab panels, windows...'
                },
                'themes': {
                    title: 'Themes',
                    text: 'Computed Styles'
                },
                'styles': {
                    title: 'Styles'
                }
            }
        },{
            text: 'View System',
            categories: {
                'layouts': {
                    title: 'Layout System',
                    text: 'absolute, flexible'
                },
                'interactions': {
                    title: 'Interactions',
                    text: 'gestures, drag & drop'
                },
                'drawing': {
                    title: 'Drawing',
                    text: 'vector, bitmap'
                },
                'dom': {
                    title: 'DOM Manipulation'
                },
                'templating': {
                    title: 'Templating',
                    text: 'iterations, conditionals'
                },
                'visual.effects': {
                    title: 'Visual Effects',
                    text: 'animations, filters...'
                },
                'localization': {
                    title: 'Localization',
                    text: 'RTL, locale libraries'
                },
                'accessibility': {
                    title: 'Accessibility',
                    text: 'focus manager, ARIA'
                }
            }
        },{
            text: 'Logic & Data',
            categories: {
                'routes': {
                    title: 'State Manager',
                    text: 'history, undo, routes...'
                },
                'data.binding': {
                    title: 'Data Binding',
                    text: '1-way, 2-way'
                },
                'modularity': {
                    title: 'Modularity',
                    text: 'MVC, MVVM'
                },
                'events': {
                    title: 'Event System',
                    text: 'views, models, generic...'
                },
                'infinite.scroll': {
                    title: 'Infinite Scrolling'
                },
                'stores': {
                    title: 'Data Models & Stores',
                    text: ' group, sort, validate'
                },
                'persistence': {
                    title: 'Persistent Data',
                    text: 'web storage, cache'
                },
                'multimedia': {
                    title: 'Multimedia',
                    text: '3D, audio, video'
                }
            }
        },{
            text: 'Server I/O',
            categories: {
                'xhr': {
                    title: 'Server Calls',
                    text: 'async, conversion'
                },
                'rpc': {
                    title: 'Server Method Invocation'
                },
                'bidata': {
                    title: '2-Way Data',
                },
                'push.notifications': {
                    title: 'Server Notifications'
                }
            }
        },{
            text: 'Enterprise',
            categories: {
                'qa': {
                    title: 'Testing',
                    text: 'dev, qa, browser farms'
                },
                'ci': {
                    title: 'Build & CI Tools',
                    text: 'minification, dev mode'
                },
                'code.sharing': {
                    title: 'Code Sharing',
                    text: 'workspace, packages'
                },
                'dev': {
                    title: 'Dev Productivity',
                    text: 'watches, IDEs'
                },
                'support': {
                    title: 'Pro Support'
                },
                'services': {
                    title: 'Pro Services'
                },
                'corp': {
                    title: 'Corporate Backing',
                    text: 'monetized product'
                },
                'open.source': {
                    title: 'Open Source'
                }
            }
        }];
        
        var frameworksArray = [{
            name: 'Pre-HTML5',
            changeCells: {
                'basic.widgets': { support: 'partial' },
                'styles': { support: 'full' },
                'layouts': { support: 'partial'}
            }
        },{
            name: 'HTML5',
            changeCells: {
                'basic.widgets': {
                    support: 'full',
                    title: '',
                    text: 'Range, Color Picker, Date/Time, Progress, Telephone...'
                },
                'styles': {
                    support: 'full',
                    title: 'Gradients, Border Radius'
                },
                'layouts': {
                    support: 'full',
                    title: 'Flexbox, Multicolumn',
                    text: ''
                },
                'interactions': {
                    support: 'partial',
                    title: 'Drag & Drop',
                    text: ''
                },
                'drawing': {
                    support: 'full',
                    title: 'SVG, Canvas',
                    text: ''
                },
                'visual.effects': {
                    support: 'full',
                    title: 'CSS Animations & Filters',
                    text: ''
                },
                'accessibility': {
                    support: 'full',
                    title: 'WAI-ARIA',
                    text: ''
                },
                'routes': {
                    support: 'full',
                    title: 'History Push State',
                    text: ''
                },
                'persistence': {
                    support: 'full',
                    title: '',
                    text: 'Local Storage, Indexed DB, App-cache'
                },
                'multimedia': {
                    support: 'full',
                    title: '',
                    text: 'Video, Audio, WebGL'
                }
            }
        },{
            name: 'Bootstrap 3.3.6',
            description: 'A framework focused mostly on styling',
            sizeJS: '40 KB',
            sizeCSS: '120 KB',
            changeCells: {
                'basic.widgets': { support: 'full' },
                'containers': { support: 'full' },
                'themes': { support: 'full' },
                'styles': { support: 'full' },
                'layouts': { support: 'partial', text: 'responsive grid' },
                'visual.effects': { support: 'partial' },
                'open.source': { support: 'full' }
            }
        },{
            name: 'AngularJS 1.5',
            sizeJS: '150 KB',
            description: 'Originally AngularJS was defined as a "framework to build frameworks"; latest ' +
                              'verbiage is "a toolset for building the framework most suited to your application development". ' +
                              'Angular is heavily DOM-focused and the 1.5 version is plagued with data binding performance ' +
                              'issues which are supposed to be addressed in version 2 (now in beta). This app uses AngularJS.',
            changeCells: {
                'dom': { support: 30, description: 'Angular uses a stripped down version of jQuery for DOM manipulation.' },
                'templating': { support: 'full' },
                'routes': { support: 'partial', text: 'routes' },
                'data.binding': { support: 'full' },
                'modularity': { support: 'partial', text: 'MVC' },
                'events': { support: 'full' },
                'stores': { support: 'partial' },
                'qa': { support: 'full' },
                'open.source': { support: 'full' }
            }
        },{
            name: 'Backbone 1.2.2',
            sizeJS: '27 KB',
            changeCells: {
                'routes': { support: 'partial', text: '' },
                'stores': { support: 'partial' },
                'xhr': { support: 'full' },
                'open.source': { support: 'full' }
            }
        },{
            name: 'jQuery 1.10.2 + jQueryUI 1.11.4',
            sizeJS: '100 KB + 235 KB',
            sizeCSS: '60 KB',
            changeCells: {
                'basic.widgets': { support: 'full' },
                'compound.widgets': { support: 'partial' },
                'containers': { support: 'full' },
                'themes': { support: 'full' },
                'styles': { support: 'partial' },
                'interactions': { support: 'partial', title: 'Drag & Drop', text: '' },
                'dom': { support: 'full' },
                'visual.effects': { support: 'partial' },
                'localization': { support: 'partial' },
                'accessibility': { support: 'partial' },
                'xhr': { support: 'partial' },
                'open.source': { support: 'full' }
            }
        },{
            name: 'Ember 1.10',
            sizeJS: '570 KB',
            changeCells: {
                'templating': { support: 'full' },
                'dom': { support: 'partial' },
                'routes': { support: 'partial' },
                'data.binding': { support: 'full' },
                'modularity': { support: 'partial', text: 'MVC' },
                'stores': { support: 'partial' },
                'open.source': { support: 'full' }
            }
        },{
            name: 'React 15',
            sizeJS: '290 KB',
            changeCells: {
                'templating': { support: 'full' },
                'dom': { support: 'partial' },
                'templating': { support: 'full' },
                'data.binding': { support: 'full' },
                'modularity': { support: 'partial' },
                'visual.effects': { support: 20, description: '"experimental"' }, 
                'events': { support: 'partial' },
                'qa': { support: 'full' },
                'open.source': { support: 'full' }
            }
        },{
            name: 'ExtJS 6',
            sizeJS: '2 MB',
            sizeCSS: '430 KB',
            description: 'One of the oldest and certainly the largest (2 MB minified JS!) front-end framework ' +
                              'out there, the latest iteration of ExtJS manifests as 2 frameworks with common core: ' +
                              'the original ExtJS as "classic" and Sencha Touch as "modern". Includes an intelligent ' +
                              'compiler that builds your app with only a sub-set of the framework that is actually used.',
            changeCells: {
                'basic.widgets': { support: 'full' },
                'compound.widgets': { support: 'full' },
                'visualizations': { support: 'full', description: 'SVG, Canvas, and VML' },
                'containers': { support: 'full' },
                'themes': { support: 'full' },
                'styles': { support: 'full' },
                'layouts': { support: 'full', text: 'abstracted responsive' },
                'interactions': { support: 'full' },
                'drawing': { support: 'full' },
                'dom': { support: 'full' },
                'templating': { support: 'full' },
                'visual.effects': { support: 'full' },
                'localization': { support: 'full' },
                'accessibility': { support: 'full' },
                'routes': { support: 'full' },
                'data.binding': { support: 'full' },
                'modularity': { support: 'full' },
                'events': { support: 'full' },
                'infinite.scroll': { support: 'full', description: 'Implemented as a part of ExtJS "most powerful web grid" that goes beyond simply appending more DOM, and actually recycles trailing DOM.' },
                'stores': { support: 'full' },
                'persistence': { support: 'full' },
                'xhr': { support: 'full' },
                'rpc': { support: 'full' },
                'bidata': { support: 'full' },
                'qa': { support: 'full' },
                'ci': { support: 'full' },
                'code.sharing': { support: 'full' },
                'dev': { support: 'full' },
                'support': { support: 'full' },
                'services': { support: 'full' },
                'corp': { support: 'full' },
                'open.source': { support: 80, description: 'While full source is available, there is no public access to active development repository.'  }
            }
        },{
            name: 'Polymer 1.0',
            sizeJS: '82 KB',
            description: 'Polymer is an attempt to polyfill WebComponents and ShadowDOM spec in all browsers ' +
                              '(the spec is only implemented in Chrome), which it does to some degree of success.',
            changeCells: {
                'basic.widgets': { support: 'full' },
                'containers': { support: 'partial', text: '' },
                'styles': { support: 'full' },
                'themes': { support: 'partial', text: '' },
                'layouts': { support: 'partial' },
                'visual.effects': { support: 'full', text: 'animations' },
                'dom': { support: 'full' },
                'templating': { support: 'full' },
                'accessibility': { support: 'full' },
                'routes': { support: 'full', text: 'routes' },
                'data.binding': { support: 'full' },
                'infinite.scroll': { support: 'full' },
                'persistence': { support: 'full', text: 'local storage' },
                'xhr': { support: 'partial', text: 'xhr' },
                'qa': { support: 'full' },
                'ci': { support: 'full' },
                'dev': { support: 'partial' },
                'open.source': { support: 'full' }
            }
        },{
            name: 'Knockout 3.4.0',
            sizeJS: '54 KB',
            changeCells: {
                'data.binding': { support: 'full' },
                'templating': { support: 'full' },
                'modularity': { support: 'partial', text: 'MVVM' },
                'open.source': { support: 'full' }
            }
        },{
            name: 'Meteor 1.3.2.4',
            sizeJS: '330 KB',
            description: 'Meteor is a full-stack framework with a lot of features revolving around ' +
                              'running the same JS code in both front-end and back-end, and synchronizing ' +
                              'the view with some bits features like optimistic rendering predictions. Many ' +
                              'parts of the Meteor framework are "unsupported community packages".',
            changeCells: {
                'data.binding': { support: 'full' },
                'stores': { support: 'full' },
                'templating': { support: 'full' },
                'persistence': { support: 'full' },
                'events': { support: 'partial' },
                'xhr': { support: 'full' },
                'rpc': { support: 'full' },
                'bidata': { support: 'full' },
                'ci': { support: 'full' },
                'support': { support: 'full' },
                'services': { support: 'full' },
                'corp': { support: 'full' },
                'qa': { support: 'partial' },
                'dev': { support: 'full' },
                'code.sharing': { support: 'full' },
                'open.source': { support: 'full' }
            }
        },{
            name: 'Aurelia 0.19.6',
            description: 'Aurelia borrows a lot of concepts from Angular (i.e. DOM-heavy directives) and tries to ' +
                              'to focus on JS preprocessors out of the box.',
            sizeJS: '25 KB',
            changeCells: {
                'data.binding': { support: 'full' },
                'routes': { support: 'full' },
                'templating': { support: 'full' },
                'modularity': { support: 'full' },
                'ci': { support: 'full' },
                'support': { support: 'full' },
                'services': { support: 'full' },
                'corp': { support: 'full' },
                'open.source': { support: 'full' }
            }
        },{
            name: 'Ionic 1.3.0',
            description: 'Ionic is focused on mobile app development and "Ionic currently requires AngularJS in order ' +
                              'to work at its full potential". Does not support Windows Phone or Blackberry.',
            sizeJS: '500 KB',
            sizeCSS: '200 KB',
            changeCells: {
                'basic.widgets': { support: 30, description: 'does not go beyond some basic styling' },
                'containers': { support: 'full', text: 'Tab Panel, Modal, Navigation' },
                'styles': { support: 'full' },
                'themes': { support: 'full' },
                'visual.effects': { support: 'partial', description: 'some of the components animate (i.e. radios)' },
                'events': { support: 'full', text: null },
                'infinite.scroll': { support: 'partial', description: 'supports local data store, but not on-demand fetching' },
                'ci': { support: 'full' },
                'support': { support: 'full' },
                'corp': { support: 'full' },
                'open.source': { support: 'partial', description: 'pay for "Enterprise" to get access to hotfixes' }
            }
        },{
            name: 'KendoUI 2016.1.412',
            description: 'Kendo is primarily a large set of UI components, with an emphasis on being ' +
                              'compatible with other frameworks, i.e. jQuery, Angular, web components.',
            sizeJS: '750 KB',
            sizeCSS: '66 KB',
            changeCells: {
                'basic.widgets': { support: 'full', description: 'possibly the largest variety out there' },
                'compound.widgets': { support: 'full', description: 'possibly the largest variety out there' },
                'visualizations': { support: 'full', description: 'SVG, Canvas, and VML' },
                'containers': { support: 'full' },
                'themes': { support: 'full' },
                'styles': { support: 'full' },
                'data.binding': { support: 'partial', text: '1-way' },
                'templating': { support: 'full' },
                'localization': { support: 'full' },
                'accessibility': { support: 'full' },
                'interactions': { support: 'full', text: 'drag and drop' },
                'events': { support: 'full' },
                'infinite.scroll': { support: 'full' },
                'stores': { support: 'full' },
                'modularity': { support: 'partial', text: 'MVVM' },
                'xhr': { support: 'full' },
                'dev': { support: 'full' },
                'services': { support: 'full' },
                'support': { support: 'full' },
                'corp': { support: 'full' },
                'open.source': { support: 'partial', description: 'latest code branches in GitHub are private' }
            }
        }];
        
        function deepCloneArray(arr) {
            return JSON.parse(JSON.stringify(arr));
        }
        
        // merge the matrix cells with frameworks for a final data structure to be rendered
        var matrix = [];
        for (var i = 0; i < frameworksArray.length; i++) {
            var framework = frameworksArray[i];
            matrix.push(framework);
            framework.categories = deepCloneArray(matrixCellsArray);
            for (var changedCell in framework.changeCells) {
                for (var j = 0; j < framework.categories.length; j++) {
                    var topCategory = framework.categories[j];
                    if (topCategory.categories[changedCell]) {
                        topCategory.categories[changedCell].support = framework.changeCells[changedCell].support;
                        topCategory.categories[changedCell].description = framework.changeCells[changedCell].description;
                        if (framework.changeCells[changedCell].hasOwnProperty('title')) topCategory.categories[changedCell].title = framework.changeCells[changedCell].title;
                        if (framework.changeCells[changedCell].hasOwnProperty('text')) topCategory.categories[changedCell].text = framework.changeCells[changedCell].text;
                    }
                }
            }
        }
        console.log(matrix);
    
        var app = angular.module('WhichJSFramework', []).config( ['$provide', function ($provide){
            // fix Angular infinite loop when manually using history pushState
            $provide.decorator('$browser', ['$delegate', function ($delegate) {
                $delegate.onUrlChange = function () {};
                $delegate.url = function () { return ""};
                return $delegate;
            }]);
        }]);
        var ctl = app.controller('Main', function ($scope, $location) {
            $scope.matrix = matrix;
            
            $scope.onClearSearch = function() { $scope.search = ''; }
            
            // function for calculating gradient highlights
            $scope.getSupportedPercentageStyle = function(supported) { // supported is 0-100
                var finalPercentage  = 0; // this needs to go from -100 to 100, from 0-100 of the supported var
                if (supported) {
                    if (supported === 'full') { finalPercentage = 100; }
                    else if (supported === 'partial') { finalPercentage = -30;}
                    else if (typeof supported === 'number') { finalPercentage = supported*2-100; }
                    return {
                        'background': 'radial-gradient(green ' + finalPercentage + '%, gray)'
                    };
                } else {
                    return null;
                }
            }
            
            // when searching, refresh tooltips and update URL
            $scope.$watch('search', function(newVal, oldVal) {
                Opentip.findElements(); // otherwise tooltips won't work after re-rendering content
                (typeof newVal !== 'undefined') && history.pushState(null, null, '?q=' + newVal);
            });
            
            // load initial search criteria
            if (location.search && location.search.indexOf('?q=') !== -1 ) {
                $scope.search = location.search.substring(location.search.indexOf('?q=') + 3);
            }
        });
    </script>
    <link href="lib/opentip.css" rel="stylesheet" type="text/css" />
    <style type="text/css">
        body { background: gray; color: white; font-family: arial; font-size: 12px; }
        .search { font-size: 15px; text-shadow: cornflowerblue 1px 1px; font-weight: bold; }
        .framework { min-width: 760px; background: white; padding: 10px; margin: 10px; border-radius: 10px 10px 0 0; box-shadow: white 0px 0px 7px; border-bottom: 1px solid gray;}
        .framework-name { display: inline; padding: 10px; font-size: 20px; font-weight: bold; text-shadow: red 1px 1px; text-shadow: red 0px 0px 5px; }
        .framework-size { display: inline; color: black; font-style: italic; border: 1px solid gray; padding: 3px; border-radius: 5px; }
        .framework-description { color: black; padding: 5px 10px;}
        .top-category-text { display: inline-block; width: 150px; font-weight: bold; font-size: 150%; color: black; padding: 10px; }
        .sub-categories { display: inline-block; width: 800px; }
        .sub-category { display: inline-block; position: relative; width: 170px; height: 40px; vertical-align: middle; background: gray; margin: 2px; text-align: center; padding: 5px; }
        .top-category.threeTilesPerLine .sub-category { width: 231px; }
        .sub-category-inner { display: flex; flex-direction: column; justify-content: center; height: 100%; }
        .sub-category-tooltip { position: absolute; right: -3px; top: -3px; color: white; background: cornflowerblue; border-radius: 10px; width: 20px; height: 20px; line-height: 20px; cursor: default; } 
    </style>
</head>
<body ng-controller="Main">

<label class="search">Search by Name: <input ng-model="search" autofocus></input></label>

<a href="" ng-if="search" ng-click="onClearSearch()">
    clear search ({{(matrix|filter:{name:search}).length}}/{{matrix.length}})
</a>

<div ng-repeat="framework in matrix | filter:{name: search} | orderBy: 'name'" class="framework">
    <div class="framework-header">
        <div class="framework-name">{{framework.name}}</div>
        <div class="framework-size" ng-if="framework.sizeJS">JS {{framework.sizeJS}}</div>
        <div class="framework-size" ng-if="framework.sizeCSS">CSS {{framework.sizeCSS}}</div>
        <div class="framework-description">{{framework.description}}</div>
    </div>
    <div ng-repeat="topCategory in framework.categories" class="top-category" ng-class="{threeTilesPerLine: topCategory.threeTilesPerLine}">
        <div class="top-category-text">{{topCategory.text}}</div>
        <div class="sub-categories">
            <div ng-repeat="subCategory in topCategory.categories" class="sub-category" 
                ng-style="getSupportedPercentageStyle(subCategory.support)"
                >
                <div class="sub-category-tooltip" ng-if="subCategory.description" ng-attr-data-ot="{{subCategory.description}}">
                    i
                </div>
                <div class="sub-category-inner">
                    <div class="sub-category-title">{{subCategory.title}}</div>
                    <div class="sub-category-text">{{subCategory.text}}</div>
                </div>
            </div>
        </div>
    </div>
</div>

</body>
</html>
